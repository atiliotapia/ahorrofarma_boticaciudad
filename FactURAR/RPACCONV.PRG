****************************************************
****** INDEXAR EL ARCHIVO PACICONV POR nombre ******
****************************************************
DEFI WIND CONSCVN FROM 22,20 TO 24,60 COLO RB/W+
DEFI WIND CONSNOM FROM 12,15 TO 14,65 COLO  BG/W
NMPCCONV=SPACE(30)
SELE A
USE PACICONV
SET ORDE TO 2
SELE B
USE CONVENIO
SET ORDE TO 1
SELE A
ACTI WIND CONSNOM
ON KEY LABEL F12 DO SELESS
@0,4 SAY 'NOMBRE :> ' COLO B/W
@0,15 GET NMPCCONV COLO B/W
READ
ON KEY LABEL F12 
DEAC WIND CONSNOM

IF NOM!=SPACE(36)
   USE HISTORIA
   SET ORDE TO 2
   * INDE HCNOM
   NUMNOM=LEN(ALLT(NOM))
   SEEK ALLT(NOM)
   IF SUBS(NOMBRE,1,NUMNOM)=ALLT(NOM)
      DEFI POPU NOMBRES FROM 11,4 SCRO 
      ON SELECTION POPU NOMBRES DO BUSCAR WITH VAL(SUBS(PROM(),1,9))
      X=1
      DO WHILE NOT EOF()
         IF SUBS(NOMBRE,1,NUMNOM)=ALLT(NOM)
            DEFI BAR X OF NOMBRES PROM ' '+STR(H_C_MOD,8)+'  '+NOMBRE+'  '+STR(L_ELECT,8)+'  '+DTOC(F_INSC)
            X=X+1
           ELSE
            EXIT 
         ENDIF
         SKIP
      ENDDO
      ACTI POPU NOMBRES
     ELSE
      ACTI WIND CONSULTAS
      SET COLO TO WR/B*
      @1,7 SAY' NO SE ENCUENTRA NOMBRE DEL PACIENTE'
      WAIT''
      SET COLO TO WR/B
      DEAC WIND CONSULTAS      
   ENDIF   
ENDIF   






PROCEDURE SELESS
CODCONV=0
ACTI WIND CONSCVN
@0,7 SAY 'Seleccione Convenio :>' GET CODCONV PICT '99' VALID CONVENIOS(CODCONV) ERROR '.... Convenio no registrado ....'
READ
DEAC WIND CONSCVN
RETURN


FUNCTION CONVENIOS
PARAMETER A
SELE B
SEEK A
IF FOUN()
   WAIT WIND ''+NOMBRE NOWA
   RETURN .T.
  ELSE
   RETURN .F.
ENDIF
