SET ECHO OFF
SET TALK OFF
SET STAT OFF
SET EXCLUSIVE OFF
SET DATE FRENCH
SET CONFIRM ON
SET AUTOSAVE ON
SET DELETE ON
SET ESCA OFF
SET SYSM OFF
SET CENTU ON
DEFI WIND INICIO FROM 0,0 TO 24,150;
     CLOSE FLOAT GROW SHADOW NOZOOM NONE
DEFI WIND EMPEZAR FROM 0,0 TO 24,80;
     CLOSE FLOAT GROW SHADOW NOZOOM FILL '€' NONE COLO B
DEFI WIND PREPARA FROM 11,20 TO 15,60;
     CLOSE FLOAT GROW SHADOW COLOR SCHEME 12
DEFI WIND HORA FROM 9,15 TO 15,65;
     CLOSE FLOAT GROW SHADOW COLOR SCHEME 12
DEFI WIND GRAF FROM 10,15 TO 12,66 TITLE 'Æ REORDENANDO FICHEROS Ø'
     
CLOS ALL
DEAC WIND ALL
CLEAR MACROS
CLEA
DEFI WIND CLAVUSUA FROM 18,25 TO 23,56 SHADOW
CODUSU='      '
LLAVE='      '
INICNOMB=' '

ACTI WIND EMPEZAR
@0,0 SAY "SISTEMA INTEGRAL DE GESTION DE FARMACIA" COLO GR+/B
DO PANTA
*@10,24 SAY "…ÕÕÕÕÕÕÕ   …Õª      …ÕÕÕÕÕÕÕÕ  …ÕÕÕÕÕÕÕª  …ÕÕÕÕÕÕÕª" COLO W+/B
*@11,24 SAY "∫          »Õº      ∫          ∫       ∫  ∫       ∫" COLO W+/B         
*@12,24 SAY "∫         ÕÕÀÕÕ     ∫          ∫       ∫  ∫       ∫" COLO W+/B
*@13,24 SAY "»ÕÕÕÕÕÕª    ∫       ∫  ÕÕÕÕÕª  ÃÕÕÕÕÕÕÕº  ÃÕÕÕÕÕÕÕº" COLO W+/B     
*@14,24 SAY "       ∫    ∫       ∫       ∫  ∫          ∫        " COLO W+/B
*@15,24 SAY "       ∫    ∫       ∫       ∫  ∫          ∫        " COLO W+/B
*@16,24 SAY "ÕÕÕÕÕÕÕº    »ÕÕÕÕº  »ÕÕÕÕÕÕÕº  »ÕÕÕÕÕÕÕº           " COLO W+/B                     
@19,31 SAY "SOCIEDAD DE BENEFICENCIA DE HUANCAYO" COLO G+/B
@23,8 SAY "Copyright (c) 2003.Derechos reservados prohibida su reproducci¢n"  COLO G+/B

NOMUSU='  '
ACTI WIND CLAVUSUA
SET COLO TO GR+/B
@0,2 SAY 'IDENTIFICACION DE USUARIOS'
@1,0 TO 1,31
X=1
SW=0
DO WHILE X<4
   @2,7 SAY 'CODIGO' GET CODUSU PICT '999999' COLO R+/B,RB/W
   @3,7 SAY 'CLAVE ' GET LLAVE COLO R+/B,N/N
   READ
   IF CODUSU="000000" AND LLAVE="ABC142"
      AUTORIZA="1"
      NOMUSU="SUPERVISOR"
      SERIEBOL="001"
      SERIEFAC="001"
      SW=1
      EXIT
   ENDIF
   USE USUARIOS.LIB
   LOCATE FOR CODIGO=CODUSU
   IF FOUN()
      CLAVE=C_L_A_V_E
      DECLA CLAV(6)
      FOR I=1 TO 6
         CLAV(I)=CHR(ASC(SUBS(CLAVE,I,1))-I*10)
      ENDFOR
      CLAVE=CLAV(1)
      FOR I=2 TO 6
         CLAVE=CLAVE+CLAV(I)
      ENDFOR
      IF LLAVE=CLAVE AND ESTADO='T'
         NOMUSU=ALLT(NOMBRE)+' '+ALLT(A_PATERNO)+' '+ALLT(A_MATERNO)
         INICNOMB=SUBS(NOMBRE,1,1)+'.'+SUBS(A_PATERNO,1,1)+'.'+SUBS(A_MATERNO,1,1)+'.'
         AUTORIZA=NIVEL
         SERIEBOL=SERIE_BOL
         SERIEFAC=SERIE_FAC
         SW=1
         X=4
        ELSE
         X=X+1 
      ENDIF   
     ELSE
      X=X+1      
   ENDIF
ENDDO   
DEAC WIND CLAVUSUA
SET COLO TO W+/B
IF SW=1
   WAIT WIND 'Bienvenido '+NOMUSU NOWA
  ELSE
   @12,20 SAY '≠≠≠≠≠ USTED NO ESTA AUTORIZADO !!!!!'
   WAIT''
   QUIT
ENDIF   
CLOS ALL

DEFINE POPUP MAESMAES FROM 1,1 SHADOW COLO SCHE 9 MOVER
DEFINE BAR 1 OF MAESMAES PROMPT 'Sub Sistema \<Facturaci¢n' SKIP FOR (AUTORIZA!="1" AND AUTORIZA!="4")
DEFINE BAR 2 OF MAESMAES PROMPT '\<Reportes Generales'
DEFINE BAR 3 OF MAESMAES PROMPT '\<Utilitarios'
DEFINE BAR 4 OF MAESMAES PROMPT '\<Salir'
ON SELECTION POPUP MAESMAES DO PROCMAES WITH BAR()


BARRA=0
ANIO=0
FEC1=SPACE(8)
FEC2=SPACE(8)
BMT=0
BMV=0
BMVV=0
OPLIQ=0

DEFINE POPUP MAES1 FROM 5,8 COLO SCHE 8
DEFINE BAR 1 OF MAES1 PROMPT '\<Ventas/Contado  '
DEFINE BAR 2 OF MAES1 PROMPT '\<Revisi¢n Tickets'
DEFINE BAR 3 OF MAES1 PROMPT '\<Cuenta Corriente Convenios '
ON SELECTION POPUP MAES1 DO PROCMAES1 WITH BAR()

DEFINE POPUP CNST FROM 3,4 
DEFINE BAR 1 OF CNST PROMPT '\<Medicinas   '
DEFINE BAR 2 OF CNST PROMPT '\-'
DEFINE BAR 3 OF CNST PROMPT '\<Facturaci¢n Pedidos Medicinas'
DEFINE BAR 4 OF CNST PROMPT 'Facturaci¢n \<Tickets'
DEFINE BAR 5 OF CNST PROMPT '\-'
DEFINE BAR 6 OF CNST PROMPT '\<Eliminaci¢n Facturaci¢n'
DEFINE BAR 7 OF CNST PROMPT '\-'
DEFINE BAR 8 OF CNST PROMPT '\<Actualizaci¢n Facturaci¢n CrÇdito'
ON SELECTION POPUP CNST DO CONSCONS WITH BAR()

DEFINE POPUP MAES FROM 4,8 COLO SCHE 8
DEFINE BAR 1 OF MAES PROMPT '\<Emisi¢n Directa de Boletas'
DEFINE BAR 2 OF MAES PROMPT '\<Consulta - Facturaci¢n '
DEFINE BAR 3 OF MAES PROMPT '\<Reportes de Facturaci¢n Contado'
DEFINE BAR 4 OF MAES PROMPT '\-'
DEFINE BAR 5 OF MAES PROMPT '\<Pedidos'
DEFINE BAR 6 OF MAES PROMPT '\<Consulta - Pedidos  '
DEFINE BAR 7 OF MAES PROMPT '\<Anulaci¢n - Pedidos '
DEFINE BAR 8 OF MAES PROMPT 'R\<eportes Pedidos no facturados'
DEFINE BAR 9 OF MAES PROMPT '\-'
DEFINE BAR 10 OF MAES PROMPT 'Consulta - \<Tickets'
DEFINE BAR 11 OF MAES PROMPT 'Rep\<ortes Tickets no facturados'
*DEFINE BAR 5 OF MAES PROMPT '\<Indigentes/Donaci¢n'
ON SELECTION POPUP MAES DO PROCCONS WITH BAR()


DEFINE POPUP MEDI FROM 5,5 
DEFINE BAR 1 OF MEDI PROMPT '\<Boletas de Venta'
DEFINE BAR 2 OF MEDI PROMPT '\<Facturas'
ON SELECTION POPUP MEDI DO PROCMEDI WITH BAR()

DEFINE POPUP CVNI FROM 1,26
DEFINE BAR 1 OF CVNI PROMPT '\<Registro de datos generales'



DEFINE POPUP REPOTE FROM 10,10 COLO SCHE 8
DEFINE BAR 1 OF REPOTE PROMPT 'M\<edicinas '
DEFINE BAR 2 OF REPOTE PROMPT '\-'
DEFINE BAR 3 OF REPOTE PROMPT '\<Tabulados de ingresos'
DEFINE BAR 4 OF REPOTE PROMPT '\-'
DEFINE BAR 5 OF REPOTE PROMPT '\<Eliminaciones/Anulaciones '
ON SELECTION POPUP REPOTE DO PROREPOTE WITH BAR()


DEFINE POPUP REPOPACI FROM 3,55
DEFINE BAR 1 OF REPOPACI PROMPT 'Pacientes Con\<venio Ambulatorio'
DEFINE BAR 2 OF REPOPACI PROMPT 'Pacientes \<Facturados con deuda'
ON SELECTION BAR 1 OF REPOPACI ACTI POPUP REPACIAMB
ON SELECTION BAR 2 OF REPOPACI DO DEUDORES


DEFINE POPUP RPMEDICI FROM 16,15
DEFINE BAR 1 OF RPMEDICI PROMPT '\<General    '
DEFINE BAR 2 OF RPMEDICI PROMPT '\<Por turno'
DEFINE BAR 3 OF RPMEDICI PROMPT '\<Segun vendedor'
ON SELECTION POPUP RPMEDICI DO PROREMEDI WITH BAR()

DEFINE POPUP REPOTABU FROM 8,55
DEFINE BAR 1 OF REPOTABU PROMPT '\<General/Contado '
DEFINE BAR 2 OF REPOTABU PROMPT '\<Espec°fico/Diario '
DEFINE BAR 3 OF REPOTABU PROMPT '\<Detallado/Serie '
DEFINE BAR 4 OF REPOTABU PROMPT '\-'
DEFINE BAR 5 OF REPOTABU PROMPT 'Recaudaci¢n \<Caja'
ON SELECTION POPUP REPOTABU DO PRORETABU WITH BAR()


DEFINE POPUP OTROS FROM 12,10 COLO SCHE 8
DEFINE BAR 1 OF OTROS PROMPT '\<Actualizar Indices  ' SKIP FOR AUTORIZA!="1" AND AUTORIZA!="4" 
DEFINE BAR 2 OF OTROS PROMPT '\<Generar Indices  ' SKIP FOR AUTORIZA!="1" AND AUTORIZA!="4" 
DEFINE BAR 3 OF OTROS PROMPT 'C\<opias' SKIP FOR AUTORIZA!="1" AND AUTORIZA!="4" 
DEFINE BAR 4 OF OTROS PROMPT '\-'
DEFINE BAR 5 OF OTROS PROMPT '\<Usuarios ' SKIP FOR AUTORIZA!="1" AND AUTORIZA!="4" 
DEFINE BAR 6 OF OTROS PROMPT '\<Mensajes de Venta'
DEFINE BAR 7 OF OTROS PROMPT '\- '
DEFINE BAR 8 OF OTROS PROMPT '\<Cambiar Usuario '
DEFINE BAR 9 OF OTROS PROMPT 'A\<cerca de .... '
ON SELECTION POPUP OTROS DO PROOTRO WITH BAR()


DEFINE POPUP BASDAT FROM 6,70
DEFINE BAR 1 OF BASDAT PROMPT '\<Atenciones  '
DEFINE BAR 2 OF BASDAT PROMPT '\<Convenios   '
DEFINE BAR 3 OF BASDAT PROMPT '\<MÇdicos     '
DEFINE BAR 4 OF BASDAT PROMPT '\<Servicios   '
ON SELECTION POPUP BASDAT DO PROBASDAT WITH BAR()


DEFINE POPUP TRAB FROM 8,70
DEFINE BAR 1 OF TRAB PROMPT '\<Nuevos Usuarios'
DEFINE BAR 2 OF TRAB PROMPT '\<Deshabilitar '
ON SELECTION POPUP TRAB DO PROTRAB WITH BAR()


DEFINE POPUP MAESFARM FROM 1,0 COLO SCHE 8
DEFINE BAR 1 OF MAESFARM PROMPT '\<Pedidos'
DEFINE BAR 2 OF MAESFARM PROMPT '\<Cambiar de usuario'
DEFINE BAR 3 OF MAESFARM PROMPT '\-'
DEFINE BAR 4 OF MAESFARM PROMPT 'Co\<nsulta - Pedidos  '
DEFINE BAR 5 OF MAESFARM PROMPT '\<Anulaci¢n - Pedidos '
DEFINE BAR 6 OF MAESFARM PROMPT 'Rep\<ortes Pedidos no facturados'
DEFINE BAR 7 OF MAESFARM PROMPT '\<Indigentes/Donaci¢n'
DEFINE BAR 8 OF MAESFARM PROMPT '\-'
DEFINE BAR 9 OF MAESFARM PROMPT 'Con\<venios CrÇditos' SKIP FOR 1=1
DEFINE BAR 10 OF MAESFARM PROMPT 'Revisi¢n Tic\<kets' SKIP FOR 100=100
DEFINE BAR 11 OF MAESFARM PROMPT '\<Reportes de Facturaci¢n Contado'
DEFINE BAR 12 OF MAESFARM PROMPT '\-'
DEFINE BAR 13 OF MAESFARM PROMPT '\<Salir'
ON SELECTION POPUP MAESFARM DO PROCFARM WITH BAR()


DEFINE POPUP MAESCAJA FROM 1,0 
DEFINE BAR 1 OF MAESCAJA PROMPT '\<Facturaci¢n Pedidos Medicinas'
DEFINE BAR 2 OF MAESCAJA PROMPT '\<Verificaci¢n-Cobro Tickets'
DEFINE BAR 3 OF MAESCAJA PROMPT '\-'
DEFINE BAR 4 OF MAESCAJA PROMPT 'F\<acturaci¢n Tickets'
DEFINE BAR 5 OF MAESCAJA PROMPT '\-'
DEFINE BAR 6 OF MAESCAJA PROMPT 'Co\<nsulta - Facturaci¢n '
DEFINE BAR 7 OF MAESCAJA PROMPT '\<Eliminaci¢n Facturaci¢n'
DEFINE BAR 8 OF MAESCAJA PROMPT '\<Tabulados de ingresos'
DEFINE BAR 9 OF MAESCAJA PROMPT 'Consulta - \<Tickets'
DEFINE BAR 10 OF MAESCAJA PROMPT '\-'
DEFINE BAR 11 OF MAESCAJA PROMPT '\<Actualizaci¢n Facturaci¢n CrÇdito'
DEFINE BAR 12 OF MAESCAJA PROMPT '\-'
DEFINE BAR 13 OF MAESCAJA PROMPT '\<Cambiar de usuario'
DEFINE BAR 14 OF MAESCAJA PROMPT '\-'
DEFINE BAR 15 OF MAESCAJA PROMPT '\<Salir'
ON SELECTION POPUP MAESCAJA DO PROCCAJA WITH BAR()


DEFINE POPUP MAESFMCJ FROM 1,0 COLO SCHE 8
DEFINE BAR 1 OF MAESFMCJ PROMPT '\<Emisi¢n Directa de Boletas' SKIP FOR !PRINT()
DEFINE BAR 2 OF MAESFMCJ PROMPT '\<Facturaci¢n Pedidos Medicinas'
DEFINE BAR 3 OF MAESFMCJ PROMPT 'Fa\<cturaci¢n Tickets'
DEFINE BAR 4 OF MAESFMCJ PROMPT '\-'
DEFINE BAR 5 OF MAESFMCJ PROMPT '\<Pedidos - Tickets '
DEFINE BAR 6 OF MAESFMCJ PROMPT 'Co\<nsulta - Pedidos  '
DEFINE BAR 7 OF MAESFMCJ PROMPT '\<Anulaci¢n - Pedidos '
DEFINE BAR 8 OF MAESFMCJ PROMPT 'Consulta - \<Tickets'
DEFINE BAR 9 OF MAESFMCJ PROMPT '\<Reportes Tickets no facturados'
DEFINE BAR 10 OF MAESFMCJ PROMPT 'Rep\<ortes Pedidos no facturados'
DEFINE BAR 11 OF MAESFMCJ PROMPT '\-'
DEFINE BAR 12 OF MAESFMCJ PROMPT 'Consu\<lta - Facturaci¢n '
DEFINE BAR 13 OF MAESFMCJ PROMPT '\<Eliminaci¢n Facturaci¢n'
DEFINE BAR 14 OF MAESFMCJ PROMPT 'Ta\<bulados de ingresos'
DEFINE BAR 15 OF MAESFMCJ PROMPT '\-'
DEFINE BAR 16 OF MAESFMCJ PROMPT '\<Actualizaci¢n Facturaci¢n CrÇdito'
DEFINE BAR 17 OF MAESFMCJ PROMPT '\-'
DEFINE BAR 18 OF MAESFMCJ PROMPT 'Cambiar de \<usuario'
DEFINE BAR 19 OF MAESFMCJ PROMPT '\-'
DEFINE BAR 20 OF MAESFMCJ PROMPT '\<Salir'
ON SELECTION POPUP MAESFMCJ DO PROCFMCJ WITH BAR()



IF SW=1
***DRIVE='H:'
USE ALMACENS
GO TOP
DRIVFARM=ALLT(FARMACIA)
DRIVFACT=ALLT(FACTURAR)
CLOS ALL
LUGAR='Huancayo'
***********
USE IMPUESTO
IGV=I_G_V
CLOS ALL
*IGV=0
***********
SET CENTU ON
@0,70 SAY ''+DTOC(DATE()) COLO GR+/RB
SET CENTU OFF

SET CLOCK TO 24,69
TITULO01='SOC.BENEFICENCIA HYO.'
*TITULO01='C.S. "JOSE A. TELLO"'
TITULO02='BOTICA "FARMABEN"'
STORE 0 TO HORAS1,HORAS2,HORAS3,HORAS4,HORAS5,HORAS6,HORAS7,HORAS8,HORAS9
NOMNUM=""
VALOR=0
YY=1
T=0


CORDE=40-(LEN('USUARIO:> '+NOMUSU)/2)
@24,CORDE SAY 'USUARIO:> '+NOMUSU COLO GR+/B

SET ESCA ON
STOR .T. TO SIGUE
ON ESCA DO SALIFALS
DO WHILE SIGUE
   DO CASE
      CASE AUTORIZA="1" OR AUTORIZA="4"
           ACTI POPU MAESMAES
      CASE AUTORIZA="2"
           ACTI POPU MAESFARM
      CASE AUTORIZA="3"
           ACTI POPU MAESCAJA
      CASE AUTORIZA="5"
*           IF PRINT()
              ACTI POPU MAESFMCJ
*             ELSE
*              WAIT WIND "LA IMPRESORA DEBE ESTAR ACTIVA" NOWA
*              EXIT
*           ENDIF
   ENDCASE   
ENDDO   
ENDIF
*****QUIT******


PROCEDURE PROCMAES
PARAMETER A
DO CASE
   CASE A=1
        ACTI POPU CNST
   CASE A=2
        ACTI POPU REPOTE
   CASE A=3
        ACTI POPU OTROS
   CASE A=4
        QUIT
ENDCASE      


PROCEDURE PROCMAES1
PARAMETER A
************
SET CENTU ON
************
DO CASE
   CASE A=1
        ACTI POPU CNST
   CASE A=2
        DO REVTICKS
   CASE A=3
        ACTI POPU CVNI
ENDCASE
*************
SET CENTU OFF
*************
RETURN


PROCEDURE CONSCONS
PARAMETER BMT
************
SET CENTU ON
************
DO CASE
   CASE BMT=1 
        ACTI POPUP MAES
   CASE BMT=3 
        DO FACTPEDI
   CASE BMT=4 
        DO FACTTICK
   CASE BMT=6 
        ACTI WIND PREPARA
        @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
        SET COLO TO N/N
        ACCE TO CLAV1
        SET COLO TO R/GB
        DEAC WIND PREPARA
        IF CLAV1='02ANULA'
           SET PROC TO ANULACTD
           DO ANULAMED
           SET PROC TO 
        ENDIF  
   CASE BMT=8
        DO ACTUVENT
ENDCASE        
*************
SET CENTU OFF
*************
RETURN

        

PROCEDURE PROCCAJA
PARAMETER BMT
************
SET CENTU ON
************
DO CASE
   CASE BMT=1
        DO FACTPEDI
   CASE BMT=2
        DO VERITICK
   CASE BMT=4
        DO FACTTICS
   CASE BMT=6
        SET PROC TO CONSMECO
        DO FACTURADOS
        SET PROC TO 
   CASE BMT=7
        ACTI WIND PREPARA
        @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
        SET COLO TO N/N
        ACCE TO CLAV1
        SET COLO TO R/GB
        DEAC WIND PREPARA
        IF CLAV1='02ANULA'
           SET PROC TO ANULACTD
           DO ANULAMED
           SET PROC TO 
        ENDIF  
   CASE BMT=8
        ACTI POPUP REPOTABU
   CASE BMT=9
        DO CONSTICK
   CASE BMT=11
        DO ACTUVENT
   CASE BMT=13
        DO CLAVE
        SET COLO TO B
        @24,0 CLEA
        CORDE=40-(LEN('USUARIO:> '+NOMUSU)/2)
        @24,CORDE SAY 'USUARIO:> '+NOMUSU COLO GR+/B
   CASE BMT=15
        CLOS ALL
        QUIT
ENDCASE        
*************
SET CENTU OFF
*************
RETURN







PROCEDURE PROCCONS
PARAMETER A
ON KEY LABEL F9 ACTI WIND CALCULATOR
DO CASE
   CASE A=1
        TIPFAC='B'
        DO MEDCONTA
   CASE A=2
        SET PROC TO CONSMECO
        DO FACTURADOS
        SET PROC TO 
   CASE A=3
        DO REPOMECO
   CASE A=4
        *       TIPFAC='B'
        *          DO MEDINDIG
   CASE A=5
        DO PEDMCTDO
   CASE A=6
           SET PROC TO CONSMECO
           DO PEDIDOS
           SET PROC TO 
   CASE A=7
           ACTI WIND PREPARA
           @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
           SET COLO TO N/N
           ACCE TO CLAV2
           SET COLO TO R/GB
           DEAC WIND PREPARA
           IF CLAV2='CTDO01'
              DO ELIMPEDI WITH 0
           ENDIF  
   CASE A=8
           DO PDMDNOFA
   CASE A=10
           DO CONSTICK
   CASE A=11
           DO TICKNOFA
ENDCASE
SET CLOCK TO 24,69
ON KEY LABEL F9 
RETURN




PROCEDURE PROCFARM
PARAMETER A
SET CENTU ON
ON KEY LABEL F9 ACTI WIND CALCULATOR
DO CASE
   CASE A=1
        DO PEDMCTDO
   CASE A=2
        DO CLAVE
        SET COLO TO B
        @24,0 CLEA
        CORDE=40-(LEN('USUARIO:> '+NOMUSU)/2)
        @24,CORDE SAY 'USUARIO:> '+NOMUSU COLO GR+/B
   CASE A=4
           SET PROC TO CONSMECO
           DO PEDIDOS
           SET PROC TO 
   CASE A=5
           ACTI WIND PREPARA
           @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
           SET COLO TO N/N
           ACCE TO CLAV2
           SET COLO TO R/GB
           DEAC WIND PREPARA
           IF CLAV2='CTDO01'
              DO ELIMPEDI WITH 0
           ENDIF  
   CASE A=6
        ACTI WIND PREPARA
        @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
        SET COLO TO N/N
        ACCE TO CLAV2
        SET COLO TO R/GB
        DEAC WIND PREPARA
        IF CLAV2='CTDO01'
           DO PDMDNOFA
        ENDIF  
   CASE A=10
        DO REVTICKS
   CASE A=11
        DO REPOMECO
   CASE A=13
        CLOS ALL
        QUIT
ENDCASE
SET CLOCK TO 24,69
ON KEY LABEL F9 
RETURN



PROCEDURE PROCFMCJ
PARAMETER A
SET CENTU ON
ON KEY LABEL F9 ACTI WIND CALCULATOR
DO CASE
   CASE A=1
        DO MEDCONTA
   CASE A=2
        DO FACTPEDI
   CASE A=3
        DO FACTTICK
   CASE A=5
        DO PEDMCTDO
   CASE A=6        
           SET PROC TO CONSMECO
           DO PEDIDOS
           SET PROC TO 
   CASE A=7
           ACTI WIND PREPARA
           @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
           SET COLO TO N/N
           ACCE TO CLAV2
           SET COLO TO R/GB
           DEAC WIND PREPARA
           IF CLAV2='CTDO01'
              DO ELIMPEDI WITH 0
           ENDIF  
   CASE A=8
        DO CONSTICK
   CASE A=9
        DO TICKNOFA
   CASE A=10
        DO PDMDNOFA
   CASE A=12
        SET PROC TO CONSMECO
        DO FACTURADOS
        SET PROC TO 
   CASE A=13
        ACTI WIND PREPARA
        @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
        SET COLO TO N/N
        ACCE TO CLAV1
        SET COLO TO R/GB
        DEAC WIND PREPARA
        IF CLAV1='02ANULA'
           SET PROC TO ANULACTD
           DO ANULAMED
           SET PROC TO 
        ENDIF  
   CASE A=14
        ACTI POPUP REPOTABU
   CASE A=16
        DO ACTUVENT
   CASE A=18
        DO CLAVE
        SET COLO TO B
        @24,0 CLEA
        CORDE=40-(LEN('USUARIO:> '+NOMUSU)/2)
        @24,CORDE SAY 'USUARIO:> '+NOMUSU COLO GR+/B
   CASE A=20
        CLOS ALL
        QUIT
ENDCASE
SET CLOCK TO 24,69
ON KEY LABEL F9 
RETURN



PROCEDURE PROCMEDI
PARAMETER A
DO CASE
   CASE A=1
        TIPFAC='B'
        DO MEDCONTA
   CASE A=2
        TIPFAC='F'
        DO MEDCONTA
ENDCASE   
RETURN




PROCEDURE PROREPOTE
PARAMETER A
************
SET CENTU ON
************
DO CASE
   CASE A=1
        ACTI POPUP RPMEDICI
   CASE A=3
        ACTI POPUP REPOTABU
   CASE A=5
        DO REPOANUL
ENDCASE
SET CLOCK TO 24,69
*************
SET CENTU OFF
*************
RETURN



PROCEDURE PROREMEDI
PARAMETER A
ON KEY LABEL F9 ACTI WIND CALCULATOR
DO CASE
   CASE A=1
        DO REPMEDIC
   CASE A=2
        DO RPMDTURN
   CASE A=3
        DO RPMDVEND
ENDCASE
ON KEY LABEL F9 
RETURN
          
PROCEDURE PRORETABU
PARAMETER A
ON KEY LABEL F9 ACTI WIND CALCULATOR
DO CASE
   CASE A=1
        SET PROCEDURE TO TABDAC
        DO GENERAL
        SET PROCEDURE TO
   CASE A=2
        SET PROCEDURE TO TABDAC
        DO DETADIARIO
        SET PROCEDURE TO
   CASE A=3
        SET PROCEDURE TO TABDAC
        DO DETALLADO
        SET PROCEDURE TO
   CASE A=5
        CLOS ALL
        SET PROC TO TABDAC
        DO PRELIMED
        SET PROC TO 
ENDCASE
SET CLOCK TO 24,69
ON KEY LABEL F9 
RETURN


PROCEDURE PROOTRO
PARAMETER A
DO CASE
   CASE A=1
      CLOS ALL
      ACTI WIND PREPARA
      @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
      SET COLO TO N/N
      ACCE TO CLAVE
      SET COLO TO R/GB
      IF CLAVE='ACTUAL'
         SET EXCLU ON
         CLEA
         SET COLO TO WR/B*
         @1,4 SAY 'ESPERE UN MOMENTO POR FAVOR....'
         USE FACTURA.DBF        
         REIN
         USE CLIENTES.DBF       
         REIN
         USE MEDICTDO.DBF
         REIN
         USE MEDICINA.DBF
         REIN
         USE MEDIHOSP.DBF
         REIN
         USE PACICONV.DBF
         REIN
         USE DETACONV.DBF
         REIN
         USE CONVENIO.DBF
         REIN
         USE CUOTASCV.DBF
         REIN
         USE ATENCION.DBF       
         REIN
         USE TABNEW.DBF   
         REIN
         USE ASIGNESP.DBF
         REIN
         USE NUEVPROD.DBF
         REIN
         USE USUARIOS.LIB
         REIN
         DEAC WIND PREPARA
         WAIT WIND "CONCLUIDO" NOWA
         SET EXCLU OFF
        ELSE
         DEAC WIND PREPARA
      ENDIF    

   CASE A=2
      SET SAFE OFF
      CLOS ALL
      ACTI WIND PREPARA
      @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
      SET COLO TO N/N
      ACCE TO CLAVE
      SET COLO TO R/GB
      IF CLAVE='INICIA'
         SET EXCLU ON
         CLEA
         SET COLO TO WR/B*
         @1,4 SAY 'ESPERE UN MOMENTO POR FAVOR....'
         
         DELE FILE FACTURA.CDX
         USE FACTURA.DBF        
         INDE ON NUMERO TAG NUMERO
         INDE ON FECHA TAG FECHA ADDI
         INDE ON SERIE+STR(NUMERO,8) TAG SERFAC ADDI
         INDE ON STR(REGISTRO,8)+TIPO TAG REGIREGI ADDI
         
         DELE FILE CLIENTES.CDX
         USE CLIENTES.DBF       
         INDE ON RUC TAG RUC
         
         DELE FILE MEDICTDO.CDX
         USE MEDICTDO.DBF
         INDE ON REGISTRO TAG REGISTRO
         INDE ON FECHA TAG FECHA ADDI
         
         DELE FILE MEDICINA.CDX
         USE MEDICINA.DBF
         INDE ON CODIGO TAG CODIGO
         INDE ON NOM_COMER TAG NOM_COMER ADDI
         INDE ON NOM_GENER TAG NOM_GENER ADDI
         
         DELE FILE MEDIHOSP.CDX
         USE MEDIHOSP.DBF
         INDE ON FECHA TAG FECHA
         INDE ON SERIE_FAC+STR(FACTURA,8) TAG SERFAC ADDI
                  
         DELE FILE PACICONV.CDX
         USE PACICONV.DBF
         INDE ON CUENTA_C TAG CUENTA_C 
         INDE ON FECHA_ALTA TAG FECHA_ALTA ADDI
         INDE ON NOMBRE TAG NOMBRE ADDI
         
         DELE FILE DETACONV.CDX         
         USE DETACONV.DBF
         INDE ON CUENTA_C TAG CUENTA_C
         INDE ON SERIE_FAC+STR(FACTURA,8) TAG SERFAC ADDI
         
         DELE FILE CONVENIO.CDX
         USE CONVENIO.DBF
         INDE ON CODIGO TAG CODIGO
         
         DELE FILE CUOTASCV.CDX
         USE CUOTASCV.DBF
         INDE ON CUENTA_C TAG CUENTA_C
         
         DELE FILE ATENCION.CDX
         USE ATENCION.DBF       
         INDE ON CODIGO TAG CODIGO 
         
         DELE FILE TABNEW.CDX
         USE TABNEW.DBF   
         INDE ON FECHA TAG FECHA
         
         DELE FILE ASIGNESP.CDX
         USE ASIGNESP.DBF
         INDE ON CODIGO TAG CODIGO
         
         DELE FILE NUEVPROD.CDX
         USE NUEVPROD.DBF
         INDE ON FECHA TAG FECHA
         
         DELE FILE USUARIOS.CDX
         USE USUARIOS.LIB
         INDE ON CODIGO TAG CODIGO
         DEAC WIND PREPARA
         WAIT WIND "CONCLUIDO" NOWA         
         SET EXCLU OFF
        ELSE
         DEAC WIND PREPARA
      ENDIF    
      SET SAFE ON
   CASE A=3
      CLOS ALL
      ACTI WIND PREPARA
      @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
      SET COLO TO N/N
      ACCE TO CLAVE
      SET COLO TO R/GB
      DEAC WIND PREPARA
      ON KEY LABEL F9 ACTI WIND CALCULATOR      
      IF CLAVE='COPIA01'
         *DO COPIAS
         !PKZIP C:\SIGEP\DATOS *.DBF *.FPT *.CDX
         WAIT WIND "Se gener¢ el archivo C:\SIGEP\DATOS.ZIP"
      ENDIF   
      ON KEY LABEL F9
   CASE A=4
      CLOS ALL
      ACTI WIND PREPARA
      @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
      SET COLO TO N/N
      ACCE TO CLAVE
      SET COLO TO R/GB
      IF CLAVE='DATOS'
         DEAC WIND PREPARA
         ACTI POPUP BASDAT
        ELSE
         DEAC WIND PREPARA
      ENDIF
   CASE A=5
      CLOS ALL
      ACTI WIND PREPARA
      @0,4 SAY 'ÆÆ INGRESE CLAVE ØØ'
      SET COLO TO N/N
      ACCE TO CLAVE
      SET COLO TO R/GB
      DEAC WIND PREPARA
      IF CLAVE='DIGITADOR'
         ACTI POPU TRAB
      ENDIF   
   CASE A=6
       DO MENSJVTA
   CASE A=8
       DO CLAVE
       SET COLO TO B
       @24,0 CLEA
       CORDE=40-(LEN('USUARIO:> '+NOMUSU)/2)
       @24,CORDE SAY 'USUARIO:> '+NOMUSU COLO GR+/B
ENDCASE
RETURN

 

PROCEDURE PROBASDAT
PARAMETER A
ON KEY LABEL F9 ACTI WIND CALCULATOR
DO CASE
   CASE A=1
        SET PROC TO FICHEROS
        DO ATENCIONES
        SET PROC TO
   CASE A=2
        SET PROC TO FICHEROS
        DO CONVENIOS
        SET PROC TO
   CASE A=3
        SET PROC TO FICHEROS
        DO MEDICOS
        SET PROC TO
   CASE A=4
        SET PROC TO FICHEROS
        DO SERVICIOS
        SET PROC TO
ENDCASE
SET CLOCK TO 24,69
ON KEY LABEL F9
RETURN
   
PROCEDURE PROTRAB
PARAMETER A
DO CASE
   CASE A=1
        IF AUTORIZA='1'
           SET PROC TO USUARIOS
           DO NUEVOS
           SET PROC TO 
        ENDIF   
   CASE A=2
        SET PROC TO USUARIOS
        DO ELIMINAR
        SET PROC TO 
ENDCASE


PROCEDURE SALIMOS
QUIT
ON KEY LABEL ESC
CLOS ALL
STOR .F. TO SIGUE
DEAC WIND ALL
DEAC MENU ALL
RELEASE MENU ALL
SET CONF OFF
RETURN


PROCEDURE SALIFALS
RETURN


